function PWACOMMERCE_SUBSCRIBE(){var JSObject=this;this.type='pwacommerce_subscribe';this.container;this.form;this.DOMDoc;this.send_btn;this.submitURL;this.init=function(){PWACJSInterface=window.parent.PWACJSInterface;this.send_btn=jQuery('#'+this.type+'_send_btn',this.container).get(0);this.form=jQuery('#'+this.type+'_form',this.container).get(0);this.addButtonsActions();if(this.form==null){return}
this.initValidation()};this.initValidation=function(){this.validator=jQuery('#'+this.form.id,this.container).validate({rules:{pwacommerce_subscribe_email:{required:!0,email:!0}},messages:{pwacommerce_subscribe_email:{email:'Invalid e-mail address'}},errorPlacement:function(error,element){var split_name=element[0].id.split('_');var id=split_name.length>1?split_name[split_name.length-1]:split_name[0];var errorContainer=jQuery('#error_'+id+'_container',JSObject.DOMDoc);error.appendTo(errorContainer)},errorElement:'span'});var $Email=jQuery('#'+this.type+'_email',this.container);$Email.data('holder',$Email.attr('placeholder'));$Email.focusin(function(){jQuery(this).attr('placeholder','')}).focusout(function(){jQuery(this).attr('placeholder',jQuery(this).data('holder'))})};this.addButtonsActions=function(){jQuery(this.send_btn).unbind('click');jQuery(this.send_btn).bind('click',function(){JSObject.disableButton(this);JSObject.validate()});JSObject.enableButton(this.send_btn);jQuery('#'+JSObject.form.id,JSObject.DOMDoc).bind('keypress',function(e){if(e.keyCode==13)return!1})};this.enableButton=function(btn){jQuery(btn).css('cursor','pointer');jQuery(btn).animate({opacity:1},100)};this.disableButton=function(btn){jQuery(btn).unbind('click');jQuery(btn).animate({opacity:0.4},100);jQuery(btn).css('cursor','default')};this.validate=function(){jQuery(this.form).validate().form();var arr_errorsYCoord=[];for(var name in this.validator.invalid){var input=jQuery(this.form[name]);arr_errorsYCoord.push(input.offset().top)}
if(arr_errorsYCoord.length==0){JSObject.sendData()}else{JSObject.addButtonsActions()}};this.sendData=function(){PWACJSInterface.Preloader.start();jQuery.ajax({url:JSObject.submitURL,type:'post',data:{email:jQuery('#'+JSObject.type+'_email',JSObject.container).val(),list:'pwacommerce'},dataType:'jsonp',success:function(responseJSON){PWACJSInterface.Preloader.remove(100);var response=Number(String(responseJSON.status));if(response===1){PWACJSInterface.Loader.display({message:'Your subscription has been confirmed.'});jQuery(JSObject.form).hide();jQuery('#'+JSObject.type+'_added',JSObject.container).show();jQuery.post(ajaxurl,{action:'pwacommerce_subscribe',pwacommerce_subscribed:1},function(response1){})}else{var message='There was an error. Please reload the page and try again in few seconds or contact the plugin administrator if the problem persists.';if(responseJSON.message&&responseJSON.message!=''){message='There was an error: '+String(responseJSON.message)}
PWACJSInterface.Loader.display({message:message});JSObject.form.reset();setTimeout(function(){var aElems=JSObject.form.elements;nElems=aElems.length;for(j=0;j<nElems;j++){aElems[j].disabled=!1}},300);JSObject.addButtonsActions()}},error:function(){PWACJSInterface.Preloader.remove(100);PWACJSInterface.Loader.display({message:'There was an error. Please reload the page and try again in few seconds or contact the plugin administrator if the problem persists.'})}})}}